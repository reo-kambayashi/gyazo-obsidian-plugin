/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var ie=Object.defineProperty;var Je=Object.getOwnPropertyDescriptor;var Ke=Object.getOwnPropertyNames;var Qe=Object.prototype.hasOwnProperty;var Xe=(t,e)=>{for(var n in e)ie(t,n,{get:e[n],enumerable:!0})},et=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ke(e))!Qe.call(t,i)&&i!==n&&ie(t,i,{get:()=>e[i],enumerable:!(o=Je(e,i))||o.enumerable});return t};var tt=t=>et(ie({},"__esModule",{value:!0}),t);var yt={};Xe(yt,{default:()=>oe});module.exports=tt(yt);var T=require("obsidian");function U(t,e){var l;let n=(l=t.alt_text)!=null?l:"",o=e!=null&&e.enableImageWidth?e.imageWidth:0,i=[];n&&i.push(n),o>0&&i.push(o.toString());let s=`![${i.join("|")}](${t.url})`;return e&&e.includePermalinkLinks===!1?s:`[${s}](${t.permalink_url})`}var fe={accessToken:"",language:"en",oauthState:"",includePermalinkLinks:!0,enableImageWidth:!1,imageWidth:250};var ye={en:{ribbonTooltip:"Gyazo viewer",accessTokenLabel:"Access token",accessTokenDesc:"Enter your Gyazo API access token",openApiDashboard:"Open API dashboard",openApiDashboardDesc:"Open Gyazo API dashboard to create a new application",languageLabel:"Language",languageDesc:"Select your preferred language",includePermalinkLinksLabel:"Image with link",includePermalinkLinksDesc:"Add links to Gyazo pages when embedding images",imageWidthLabel:"Image width",imageWidthDesc:"Set default width for embedded images",save:"Save",copyUrl:"Copy URL",openInBrowser:"Open in browser",copyMarkdown:"Copy markdown",copyMarkdownGif:"Copy GIF markdown",copyMarkdownMp4:"Copy MP4 markdown",detailViewTitle:"Image details",selectImageToView:"Select an image to view details",uploadDate:"Uploaded at",description:"Description",title:"Title",app:"App",source:"Source",ocr:"OCR",upgradeToProTitle:"Upgrade to Gyazo Pro",upgradeToProDesc:"Upgrade to Gyazo Pro to access all your captures",upgradeToProButton:"Upgrade now",noImages:"No captures found",loadingImages:"Loading captures...",errorLoadingImages:"Error loading captures",loginRequired:"Gyazo account required",loginRequiredDesc:"Please sign up or log in to continue using Gyazo Viewer",loginButton:"Sign up / log in",revokeToken:"Revoke access",revokeTokenDesc:"Revoke Gyazo access token",tokenRevoked:"Access token has been revoked",imageCopiedToEditor:"Image inserted into editor",imageCopiedToClipboard:"Image copied to clipboard",imageOpenedInBrowser:"Image opened in browser",openSettings:"Open plugin settings",openSettingsDesc:"Configure your Gyazo API access token in the plugin settings",downloadGyazo:"Download Gyazo",downloadGyazoDesc:"New to Gyazo? Download and install it to get started",noAccessToken:"Please log in or sign up to start using Gyazo",refreshButton:"Refresh"},ja:{ribbonTooltip:"Gyazo \u30D3\u30E5\u30FC\u30EF",accessTokenLabel:"\u30A2\u30AF\u30BB\u30B9\u30C8\u30FC\u30AF\u30F3",accessTokenDesc:"Gyazo API\u306E\u30A2\u30AF\u30BB\u30B9\u30C8\u30FC\u30AF\u30F3\u3092\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044",openApiDashboard:"API\u30C0\u30C3\u30B7\u30E5\u30DC\u30FC\u30C9\u3092\u958B\u304F",openApiDashboardDesc:"Gyazo API\u30C0\u30C3\u30B7\u30E5\u30DC\u30FC\u30C9\u3092\u958B\u3044\u3066\u65B0\u3057\u3044\u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3\u3092\u4F5C\u6210",languageLabel:"\u8A00\u8A9E",languageDesc:"\u8868\u793A\u8A00\u8A9E\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044",includePermalinkLinksLabel:"\u30EA\u30F3\u30AF\u3064\u304D\u753B\u50CF",includePermalinkLinksDesc:"\u753B\u50CF\u57CB\u3081\u8FBC\u307F\u6642\u306BGyazo\u30DA\u30FC\u30B8\u3078\u306E\u30EA\u30F3\u30AF\u3092\u8FFD\u52A0\u3059\u308B",imageWidthLabel:"\u753B\u50CF\u306E\u5E45",imageWidthDesc:"\u57CB\u3081\u8FBC\u307F\u753B\u50CF\u306E\u30C7\u30D5\u30A9\u30EB\u30C8\u5E45\u3092\u8A2D\u5B9A",save:"\u4FDD\u5B58",copyUrl:"URL\u3092\u30B3\u30D4\u30FC",openInBrowser:"\u30D6\u30E9\u30A6\u30B6\u3067\u958B\u304F",copyMarkdown:"\u30DE\u30FC\u30AF\u30C0\u30A6\u30F3\u3092\u30B3\u30D4\u30FC",copyMarkdownGif:"GIF\u5F62\u5F0F\u3067\u30DE\u30FC\u30AF\u30C0\u30A6\u30F3\u3092\u30B3\u30D4\u30FC",copyMarkdownMp4:"MP4\u5F62\u5F0F\u3067\u30DE\u30FC\u30AF\u30C0\u30A6\u30F3\u3092\u30B3\u30D4\u30FC",detailViewTitle:"\u753B\u50CF\u8A73\u7D30",selectImageToView:"\u8A73\u7D30\u3092\u8868\u793A\u3059\u308B\u753B\u50CF\u3092\u9078\u629E\u3057\u3066\u304F\u3060\u3055\u3044",uploadDate:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u65E5\u6642",description:"\u8AAC\u660E",title:"\u30BF\u30A4\u30C8\u30EB",app:"\u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3",source:"\u30AD\u30E3\u30D7\u30C1\u30E3\u5143",ocr:"OCR",upgradeToProTitle:"Gyazo Pro\u306B\u30A2\u30C3\u30D7\u30B0\u30EC\u30FC\u30C9",upgradeToProDesc:"Gyazo Pro\u306B\u30A2\u30C3\u30D7\u30B0\u30EC\u30FC\u30C9\u3057\u3066\u5168\u3066\u306E\u30AD\u30E3\u30D7\u30C1\u30E3\u306B\u30A2\u30AF\u30BB\u30B9\u3057\u307E\u3057\u3087\u3046",upgradeToProButton:"\u4ECA\u3059\u3050\u30A2\u30C3\u30D7\u30B0\u30EC\u30FC\u30C9",noImages:"\u30AD\u30E3\u30D7\u30C1\u30E3\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093",loadingImages:"\u30AD\u30E3\u30D7\u30C1\u30E3\u3092\u8AAD\u307F\u8FBC\u307F\u4E2D...",errorLoadingImages:"\u30AD\u30E3\u30D7\u30C1\u30E3\u306E\u8AAD\u307F\u8FBC\u307F\u306B\u5931\u6557\u3057\u307E\u3057\u305F",loginRequired:"Gyazo\u30A2\u30AB\u30A6\u30F3\u30C8\u304C\u5FC5\u8981\u3067\u3059",loginRequiredDesc:"Gyazo\u30AD\u30E3\u30D7\u30C1\u30E3\u3092\u5229\u7528\u3059\u308B\u306B\u306F\u30B5\u30A4\u30F3\u30A2\u30C3\u30D7\u307E\u305F\u306F\u30ED\u30B0\u30A4\u30F3\u3057\u3066\u304F\u3060\u3055\u3044",loginButton:"\u30B5\u30A4\u30F3\u30A2\u30C3\u30D7 / \u30ED\u30B0\u30A4\u30F3",revokeToken:"\u30A2\u30AF\u30BB\u30B9\u53D6\u308A\u6D88\u3057",revokeTokenDesc:"Gyazo\u30A2\u30AF\u30BB\u30B9\u30C8\u30FC\u30AF\u30F3\u3092\u53D6\u308A\u6D88\u3059",tokenRevoked:"\u30A2\u30AF\u30BB\u30B9\u30C8\u30FC\u30AF\u30F3\u304C\u53D6\u308A\u6D88\u3055\u308C\u307E\u3057\u305F",imageCopiedToEditor:"\u30A8\u30C7\u30A3\u30BF\u306B\u753B\u50CF\u3092\u633F\u5165\u3057\u307E\u3057\u305F",imageCopiedToClipboard:"\u753B\u50CF\u3092\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u306B\u30B3\u30D4\u30FC\u3057\u307E\u3057\u305F",imageOpenedInBrowser:"\u30D6\u30E9\u30A6\u30B6\u3067\u753B\u50CF\u304C\u958B\u304B\u308C\u307E\u3057\u305F",openSettings:"\u30D7\u30E9\u30B0\u30A4\u30F3\u8A2D\u5B9A\u3092\u958B\u304F",openSettingsDesc:"\u30D7\u30E9\u30B0\u30A4\u30F3\u8A2D\u5B9A\u3067Gyazo API\u30A2\u30AF\u30BB\u30B9\u30C8\u30FC\u30AF\u30F3\u3092\u8A2D\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044",downloadGyazo:"Gyazo\u3092\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9",downloadGyazoDesc:"Gyazo\u3092\u521D\u3081\u3066\u4F7F\u7528\u3059\u308B\u5834\u5408\u306F\u3001\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u3057\u3066\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u3066\u304F\u3060\u3055\u3044",noAccessToken:"Gyazo\u3092\u4F7F\u7528\u3059\u308B\u306B\u306F\u30ED\u30B0\u30A4\u30F3\u307E\u305F\u306F\u30B5\u30A4\u30F3\u30A2\u30C3\u30D7\u304C\u5FC5\u8981\u3067\u3059",refreshButton:"\u66F4\u65B0"}};var $=require("obsidian"),F="https://api.gyazo.com",ve="https://gyazo.com/oauth/obsidian/callback",ke="YOUR_CLIENT_ID",nt="YOUR_CLIENT_SECRET",L=class{constructor(e){this.accessToken=e}async getImages(e=100){if(!this.accessToken)throw new Error("No access token provided");try{let n=new URL(`${F}/api/images`);return n.searchParams.append("access_token",this.accessToken),n.searchParams.append("per_page",e.toString()),(await(0,$.requestUrl)({url:n.toString(),method:"GET"})).json}catch(n){throw console.error("Error fetching Gyazo images:",n),n}}generateAuthorizeUrl(){let e=this.generateRandomState(),n=new URL(`${F}/oauth/authorize`);return n.searchParams.append("client_id",ke),n.searchParams.append("redirect_uri",ve),n.searchParams.append("response_type","code"),n.searchParams.append("scope","public upload"),n.searchParams.append("state",e),n.toString()}generateRandomState(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}getCodeFromUrl(e){try{return new URL(e).searchParams.get("code")}catch(n){return console.error("Error parsing URL:",n),null}}async getAccessToken(e){try{let n={url:`${F}/oauth/token`,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:ke,client_secret:nt,redirect_uri:ve,grant_type:"authorization_code",code:e})};return(await(0,$.requestUrl)(n)).json.access_token}catch(n){throw console.error("Error getting access token:",n),n}}async validateAccessToken(){if(!this.accessToken)return!1;try{let e=new URL(`${F}/api/users/me`);return e.searchParams.append("access_token",this.accessToken),(await(0,$.requestUrl)({url:e.toString(),method:"GET"})).status===200}catch(e){return console.error("Error validating access token:",e),!1}}};var I=require("obsidian");var q=class extends I.PluginSettingTab{constructor(e,n){super(e,n),this.plugin=n}display(){let{containerEl:e}=this,n=this.plugin.getTranslation();e.empty();let o=new I.Setting(e).setName(n.accessTokenLabel).setDesc(n.accessTokenDesc);if(this.plugin.settings.accessToken){let a=this.plugin.settings.accessToken.substring(0,4)+"..."+this.plugin.settings.accessToken.substring(this.plugin.settings.accessToken.length-4);o.addText(s=>s.setValue(a).setDisabled(!0)),o.addButton(s=>s.setButtonText(n.revokeToken).setTooltip(n.revokeTokenDesc).onClick(async()=>{this.plugin.settings.accessToken="",this.plugin.api=new L(""),await this.plugin.saveSettings(),new I.Notice(n.tokenRevoked),this.display()}))}else o.addText(a=>a.setPlaceholder("Enter your Gyazo access token").setValue("").onChange(async s=>{this.plugin.settings.accessToken=s,await this.plugin.saveSettings()})),o.addButton(a=>a.setButtonText(n.openApiDashboard).setTooltip(n.openApiDashboardDesc).onClick(()=>{window.open("https://gyazo.com/oauth/applications","_blank")}));new I.Setting(e).setName(n.languageLabel).setDesc(n.languageDesc).addDropdown(a=>a.addOption("en","English").addOption("ja","\u65E5\u672C\u8A9E").setValue(this.plugin.settings.language).onChange(async s=>{this.plugin.settings.language=s,await this.plugin.saveSettings(),this.display()})),new I.Setting(e).setName(n.includePermalinkLinksLabel).setDesc(n.includePermalinkLinksDesc).addToggle(a=>a.setValue(this.plugin.settings.includePermalinkLinks).onChange(async s=>{this.plugin.settings.includePermalinkLinks=s,await this.plugin.saveSettings()})),new I.Setting(e).setName(n.imageWidthLabel).setDesc(n.imageWidthDesc).addText(a=>a.setPlaceholder("250").setValue(String(this.plugin.settings.imageWidth)).onChange(async s=>{let l=parseInt(s);!isNaN(l)&&l>0&&(this.plugin.settings.imageWidth=l,await this.plugin.saveSettings(),this.display())})).addToggle(a=>a.setValue(this.plugin.settings.enableImageWidth).onChange(async s=>{this.plugin.settings.enableImageWidth=s,await this.plugin.saveSettings()}))}};var Q,f,Ce,ot,G,we,Ie,Pe,De,le,re,se,at,O={},Le=[],it=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,X=Array.isArray;function P(t,e){for(var n in e)t[n]=e[n];return t}function ce(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function rt(t,e,n){var o,i,a,s={};for(a in e)a=="key"?o=e[a]:a=="ref"?i=e[a]:s[a]=e[a];if(arguments.length>2&&(s.children=arguments.length>3?Q.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(a in t.defaultProps)s[a]===void 0&&(s[a]=t.defaultProps[a]);return Z(t,s,o,i,null)}function Z(t,e,n,o,i){var a={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i==null?++Ce:i,__i:-1,__u:0};return i==null&&f.vnode!=null&&f.vnode(a),a}function ee(){return{current:null}}function S(t){return t.children}function J(t,e){this.props=t,this.context=e}function E(t,e){if(e==null)return t.__?E(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?E(t):null}function Ge(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Ge(t)}}function be(t){(!t.__d&&(t.__d=!0)&&G.push(t)&&!K.__r++||we!=f.debounceRendering)&&((we=f.debounceRendering)||Ie)(K)}function K(){for(var t,e,n,o,i,a,s,l=1;G.length;)G.length>l&&G.sort(Pe),t=G.shift(),l=G.length,t.__d&&(n=void 0,i=(o=(e=t).__v).__e,a=[],s=[],e.__P&&((n=P({},o)).__v=o.__v+1,f.vnode&&f.vnode(n),_e(e.__P,n,o,e.__n,e.__P.namespaceURI,32&o.__u?[i]:null,a,i==null?E(o):i,!!(32&o.__u),s),n.__v=o.__v,n.__.__k[n.__i]=n,Ne(a,n,s),n.__e!=i&&Ge(n)));K.__r=0}function Ee(t,e,n,o,i,a,s,l,_,c,p){var r,g,d,w,z,h,y=o&&o.__k||Le,m=e.length;for(_=st(n,e,y,_,m),r=0;r<m;r++)(d=n.__k[r])!=null&&(g=d.__i==-1?O:y[d.__i]||O,d.__i=r,h=_e(t,d,g,i,a,s,l,_,c,p),w=d.__e,d.ref&&g.ref!=d.ref&&(g.ref&&ue(g.ref,null,d),p.push(d.ref,d.__c||w,d)),z==null&&w!=null&&(z=w),4&d.__u||g.__k===d.__k?_=Se(d,_,t):typeof d.type=="function"&&h!==void 0?_=h:w&&(_=w.nextSibling),d.__u&=-7);return n.__e=z,_}function st(t,e,n,o,i){var a,s,l,_,c,p=n.length,r=p,g=0;for(t.__k=new Array(i),a=0;a<i;a++)(s=e[a])!=null&&typeof s!="boolean"&&typeof s!="function"?(_=a+g,(s=t.__k[a]=typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?Z(null,s,null,null,null):X(s)?Z(S,{children:s},null,null,null):s.constructor==null&&s.__b>0?Z(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=t,s.__b=t.__b+1,l=null,(c=s.__i=lt(s,n,_,r))!=-1&&(r--,(l=n[c])&&(l.__u|=2)),l==null||l.__v==null?(c==-1&&(i>p?g--:i<p&&g++),typeof s.type!="function"&&(s.__u|=4)):c!=_&&(c==_-1?g--:c==_+1?g++:(c>_?g--:g++,s.__u|=4))):t.__k[a]=null;if(r)for(a=0;a<p;a++)(l=n[a])!=null&&(2&l.__u)==0&&(l.__e==o&&(o=E(l)),Ae(l,l));return o}function Se(t,e,n){var o,i;if(typeof t.type=="function"){for(o=t.__k,i=0;o&&i<o.length;i++)o[i]&&(o[i].__=t,e=Se(o[i],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=E(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function lt(t,e,n,o){var i,a,s=t.key,l=t.type,_=e[n];if(_===null&&t.key==null||_&&s==_.key&&l==_.type&&(2&_.__u)==0)return n;if(o>(_!=null&&(2&_.__u)==0?1:0))for(i=n-1,a=n+1;i>=0||a<e.length;){if(i>=0){if((_=e[i])&&(2&_.__u)==0&&s==_.key&&l==_.type)return i;i--}if(a<e.length){if((_=e[a])&&(2&_.__u)==0&&s==_.key&&l==_.type)return a;a++}}return-1}function Te(t,e,n){e[0]=="-"?t.setProperty(e,n==null?"":n):t[e]=n==null?"":typeof n!="number"||it.test(e)?n:n+"px"}function Y(t,e,n,o,i){var a,s;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||Te(t.style,e,"");if(n)for(e in n)o&&n[e]==o[e]||Te(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")a=e!=(e=e.replace(De,"$1")),s=e.toLowerCase(),e=s in t||e=="onFocusOut"||e=="onFocusIn"?s.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+a]=n,n?o?n.u=o.u:(n.u=le,t.addEventListener(e,a?se:re,a)):t.removeEventListener(e,a?se:re,a);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n==null?"":n;break e}catch(l){}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function ze(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=le++;else if(e.t<n.u)return;return n(f.event?f.event(e):e)}}}function _e(t,e,n,o,i,a,s,l,_,c){var p,r,g,d,w,z,h,y,m,D,b,B,M,me,j,V,ae,C=e.type;if(e.constructor!=null)return null;128&n.__u&&(_=!!(32&n.__u),a=[l=e.__e=n.__e]),(p=f.__b)&&p(e);e:if(typeof C=="function")try{if(y=e.props,m="prototype"in C&&C.prototype.render,D=(p=C.contextType)&&o[p.__c],b=p?D?D.props.value:p.__:o,n.__c?h=(r=e.__c=n.__c).__=r.__E:(m?e.__c=r=new C(y,b):(e.__c=r=new J(y,b),r.constructor=C,r.render=_t),D&&D.sub(r),r.props=y,r.state||(r.state={}),r.context=b,r.__n=o,g=r.__d=!0,r.__h=[],r._sb=[]),m&&r.__s==null&&(r.__s=r.state),m&&C.getDerivedStateFromProps!=null&&(r.__s==r.state&&(r.__s=P({},r.__s)),P(r.__s,C.getDerivedStateFromProps(y,r.__s))),d=r.props,w=r.state,r.__v=e,g)m&&C.getDerivedStateFromProps==null&&r.componentWillMount!=null&&r.componentWillMount(),m&&r.componentDidMount!=null&&r.__h.push(r.componentDidMount);else{if(m&&C.getDerivedStateFromProps==null&&y!==d&&r.componentWillReceiveProps!=null&&r.componentWillReceiveProps(y,b),!r.__e&&r.shouldComponentUpdate!=null&&r.shouldComponentUpdate(y,r.__s,b)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(r.props=y,r.state=r.__s,r.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(W){W&&(W.__=e)}),B=0;B<r._sb.length;B++)r.__h.push(r._sb[B]);r._sb=[],r.__h.length&&s.push(r);break e}r.componentWillUpdate!=null&&r.componentWillUpdate(y,r.__s,b),m&&r.componentDidUpdate!=null&&r.__h.push(function(){r.componentDidUpdate(d,w,z)})}if(r.context=b,r.props=y,r.__P=t,r.__e=!1,M=f.__r,me=0,m){for(r.state=r.__s,r.__d=!1,M&&M(e),p=r.render(r.props,r.state,r.context),j=0;j<r._sb.length;j++)r.__h.push(r._sb[j]);r._sb=[]}else do r.__d=!1,M&&M(e),p=r.render(r.props,r.state,r.context),r.state=r.__s;while(r.__d&&++me<25);r.state=r.__s,r.getChildContext!=null&&(o=P(P({},o),r.getChildContext())),m&&!g&&r.getSnapshotBeforeUpdate!=null&&(z=r.getSnapshotBeforeUpdate(d,w)),V=p,p!=null&&p.type===S&&p.key==null&&(V=xe(p.props.children)),l=Ee(t,X(V)?V:[V],e,n,o,i,a,s,l,_,c),r.base=e.__e,e.__u&=-161,r.__h.length&&s.push(r),h&&(r.__E=r.__=null)}catch(W){if(e.__v=null,_||a!=null)if(W.then){for(e.__u|=_?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;a[a.indexOf(l)]=null,e.__e=l}else for(ae=a.length;ae--;)ce(a[ae]);else e.__e=n.__e,e.__k=n.__k;f.__e(W,e,n)}else a==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=ct(n.__e,e,n,o,i,a,s,_,c);return(p=f.diffed)&&p(e),128&e.__u?void 0:l}function Ne(t,e,n){for(var o=0;o<n.length;o++)ue(n[o],n[++o],n[++o]);f.__c&&f.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(a){a.call(i)})}catch(a){f.__e(a,i.__v)}})}function xe(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:X(t)?t.map(xe):P({},t)}function ct(t,e,n,o,i,a,s,l,_){var c,p,r,g,d,w,z,h=n.props,y=e.props,m=e.type;if(m=="svg"?i="http://www.w3.org/2000/svg":m=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),a!=null){for(c=0;c<a.length;c++)if((d=a[c])&&"setAttribute"in d==!!m&&(m?d.localName==m:d.nodeType==3)){t=d,a[c]=null;break}}if(t==null){if(m==null)return document.createTextNode(y);t=document.createElementNS(i,m,y.is&&y),l&&(f.__m&&f.__m(e,a),l=!1),a=null}if(m==null)h===y||l&&t.data==y||(t.data=y);else{if(a=a&&Q.call(t.childNodes),h=n.props||O,!l&&a!=null)for(h={},c=0;c<t.attributes.length;c++)h[(d=t.attributes[c]).name]=d.value;for(c in h)if(d=h[c],c!="children"){if(c=="dangerouslySetInnerHTML")r=d;else if(!(c in y)){if(c=="value"&&"defaultValue"in y||c=="checked"&&"defaultChecked"in y)continue;Y(t,c,null,d,i)}}for(c in y)d=y[c],c=="children"?g=d:c=="dangerouslySetInnerHTML"?p=d:c=="value"?w=d:c=="checked"?z=d:l&&typeof d!="function"||h[c]===d||Y(t,c,d,h[c],i);if(p)l||r&&(p.__html==r.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(r&&(t.innerHTML=""),Ee(e.type=="template"?t.content:t,X(g)?g:[g],e,n,o,m=="foreignObject"?"http://www.w3.org/1999/xhtml":i,a,s,a?a[0]:n.__k&&E(n,0),l,_),a!=null)for(c=a.length;c--;)ce(a[c]);l||(c="value",m=="progress"&&w==null?t.removeAttribute("value"):w!=null&&(w!==t[c]||m=="progress"&&!w||m=="option"&&w!=h[c])&&Y(t,c,w,h[c],i),c="checked",z!=null&&z!=t[c]&&Y(t,c,z,h[c],i))}return t}function ue(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(i){f.__e(i,n)}}function Ae(t,e,n){var o,i;if(f.unmount&&f.unmount(t),(o=t.ref)&&(o.current&&o.current!=t.__e||ue(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(a){f.__e(a,e)}o.base=o.__P=null}if(o=t.__k)for(i=0;i<o.length;i++)o[i]&&Ae(o[i],e,n||typeof t.type!="function");n||ce(t.__e),t.__c=t.__=t.__e=void 0}function _t(t,e,n){return this.constructor(t,n)}function N(t,e,n){var o,i,a,s;e==document&&(e=document.documentElement),f.__&&f.__(t,e),i=(o=typeof n=="function")?null:n&&n.__k||e.__k,a=[],s=[],_e(e,t=(!o&&n||e).__k=rt(S,null,[t]),i||O,O,e.namespaceURI,!o&&n?[n]:i?null:e.firstChild?Q.call(e.childNodes):null,a,!o&&n?n:i?i.__e:e.firstChild,o,s),Ne(a,t,s)}Q=Le.slice,f={__e:function(t,e,n,o){for(var i,a,s;e=e.__;)if((i=e.__c)&&!i.__)try{if((a=i.constructor)&&a.getDerivedStateFromError!=null&&(i.setState(a.getDerivedStateFromError(t)),s=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,o||{}),s=i.__d),s)return i.__E=i}catch(l){t=l}throw t}},Ce=0,ot=function(t){return t!=null&&t.constructor==null},J.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=P({},this.state),typeof t=="function"&&(t=t(P({},n),this.props)),t&&P(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),be(this))},J.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),be(this))},J.prototype.render=S,G=[],Ie=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Pe=function(t,e){return t.__v.__b-e.__v.__b},K.__r=0,De=/(PointerCapture)$|Capture$/i,le=0,re=ze(!1),se=ze(!0),at=0;var ne,v,pe,Re,de=0,je=[],k=f,Me=k.__b,Ve=k.__r,We=k.diffed,Ue=k.__c,Oe=k.unmount,He=k.__;function Fe(t,e){k.__h&&k.__h(v,t,de||e),de=0;var n=v.__H||(v.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function he(t){return de=1,ut(qe,t)}function ut(t,e,n){var o=Fe(ne++,2);if(o.t=t,!o.__c&&(o.__=[n?n(e):qe(void 0,e),function(l){var _=o.__N?o.__N[0]:o.__[0],c=o.t(_,l);_!==c&&(o.__N=[c,o.__[1]],o.__c.setState({}))}],o.__c=v,!v.__f)){var i=function(l,_,c){if(!o.__c.__H)return!0;var p=o.__c.__H.__.filter(function(g){return!!g.__c});if(p.every(function(g){return!g.__N}))return!a||a.call(this,l,_,c);var r=o.__c.props!==l;return p.forEach(function(g){if(g.__N){var d=g.__[0];g.__=g.__N,g.__N=void 0,d!==g.__[0]&&(r=!0)}}),a&&a.call(this,l,_,c)||r};v.__f=!0;var a=v.shouldComponentUpdate,s=v.componentWillUpdate;v.componentWillUpdate=function(l,_,c){if(this.__e){var p=a;a=void 0,i(l,_,c),a=p}s&&s.call(this,l,_,c)},v.shouldComponentUpdate=i}return o.__N||o.__}function $e(t,e){var n=Fe(ne++,3);!k.__s&&gt(n.__H,e)&&(n.__=t,n.u=e,v.__H.__h.push(n))}function pt(){for(var t;t=je.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(te),t.__H.__h.forEach(ge),t.__H.__h=[]}catch(e){t.__H.__h=[],k.__e(e,t.__v)}}k.__b=function(t){v=null,Me&&Me(t)},k.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),He&&He(t,e)},k.__r=function(t){Ve&&Ve(t),ne=0;var e=(v=t.__c).__H;e&&(pe===v?(e.__h=[],v.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(te),e.__h.forEach(ge),e.__h=[],ne=0)),pe=v},k.diffed=function(t){We&&We(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(je.push(e)!==1&&Re===k.requestAnimationFrame||((Re=k.requestAnimationFrame)||dt)(pt)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),pe=v=null},k.__c=function(t,e){e.some(function(n){try{n.__h.forEach(te),n.__h=n.__h.filter(function(o){return!o.__||ge(o)})}catch(o){e.some(function(i){i.__h&&(i.__h=[])}),e=[],k.__e(o,n.__v)}}),Ue&&Ue(t,e)},k.unmount=function(t){Oe&&Oe(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{te(o)}catch(i){e=i}}),n.__H=void 0,e&&k.__e(e,n.__v))};var Be=typeof requestAnimationFrame=="function";function dt(t){var e,n=function(){clearTimeout(o),Be&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,35);Be&&(e=requestAnimationFrame(n))}function te(t){var e=v,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),v=e}function ge(t){var e=v;t.__c=t.__(),v=e}function gt(t,e){return!t||t.length!==e.length||e.some(function(n,o){return n!==t[o]})}function qe(t,e){return typeof e=="function"?e(t):e}var Ze=require("obsidian");var Ye=require("obsidian");var ht=0,St=Array.isArray;function u(t,e,n,o,i,a){e||(e={});var s,l,_=e;if("ref"in _)for(l in _={},e)l=="ref"?s=e[l]:_[l]=e[l];var c={type:t,props:_,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--ht,__i:-1,__u:0,__source:i,__self:a};if(typeof t=="function"&&(s=t.defaultProps))for(l in s)_[l]===void 0&&(_[l]=s[l]);return f.vnode&&f.vnode(c),c}var A="gyazo-detail-view",x=class extends Ye.ItemView{constructor(n,o){super(n);this.contentRef=ee();this.image=null;this.plugin=o}getViewType(){return A}getDisplayText(){return this.plugin.getTranslation().detailViewTitle}async onOpen(){this.contentEl.empty(),this.contentEl.addClass("gyazo-detail-view-container");let n=this.contentEl.createDiv({cls:"gyazo-detail-react-container"});this.contentRef.current=n,this.renderComponent()}async onClose(){this.contentRef.current&&N(null,this.contentRef.current)}setImage(n){this.image=n,this.renderComponent()}renderComponent(){this.reactComponent=u(mt,{image:this.image,translations:this.plugin.getTranslation()}),this.contentRef.current&&N(this.reactComponent,this.contentRef.current)}},mt=({image:t,translations:e})=>{var o,i,a,s,l,_;if($e(()=>{if(t){let c=document.querySelector(".gyazo-detail-view-container");c&&c.scrollTo({top:0})}},[t]),!t)return u("div",{className:"gyazo-detail-empty",children:e.selectImageToView});let n=c=>{try{return new Date(c).toLocaleString()}catch(p){return c}};return u("div",{className:"gyazo-detail-view",children:[u("div",{className:"gyazo-detail-image-container",children:u("a",{href:t.permalink_url,onClick:c=>{c.preventDefault(),window.open(t.permalink_url,"_blank")},draggable:!1,children:u("img",{src:t.url,alt:"",className:"gyazo-detail-image",draggable:!1})})}),t.metadata.desc&&u("h2",{className:"gyazo-image-description",children:t.metadata.desc}),u("div",{className:"gyazo-metadata",children:[u("div",{className:"gyazo-metadata-item",children:[u("div",{className:"gyazo-metadata-label",children:e.uploadDate}),u("div",{className:"gyazo-metadata-value",children:u("a",{href:`https://gyazo.com/captures?jump=${t.image_id}`,onClick:c=>{c.preventDefault(),window.open(`https://gyazo.com/captures?jump=${t.image_id}`,"_blank")},className:"gyazo-source-link",children:n(t.created_at)})})]}),((o=t.metadata)==null?void 0:o.app)&&u("div",{className:"gyazo-metadata-item",children:[u("div",{className:"gyazo-metadata-label",children:e.app}),u("div",{className:"gyazo-metadata-value",children:t.metadata.app})]}),((i=t.metadata)==null?void 0:i.url)&&u("div",{className:"gyazo-metadata-item",children:[u("div",{className:"gyazo-metadata-label",children:e.source}),u("div",{className:"gyazo-metadata-value",children:(a=t.metadata)!=null&&a.url?u("a",{href:t.metadata.url,onClick:c=>{var p;c.preventDefault(),window.open((p=t.metadata)==null?void 0:p.url,"_blank")},className:"gyazo-source-link",children:(s=t.metadata)==null?void 0:s.title}):u("span",{children:(l=t.metadata)==null?void 0:l.title})})]}),((_=t.ocr)==null?void 0:_.description)&&u("div",{className:"gyazo-metadata-item",children:[u("div",{className:"gyazo-metadata-label",children:e.ocr}),u("div",{className:"gyazo-metadata-value",children:t.ocr.description})]})]})]})};var R="gyazo-view",H=class extends Ze.ItemView{constructor(n,o){super(n);this.galleryRef=ee();this.images=[];this.loading=!0;this.error=null;this.plugin=o}getViewType(){return R}getDisplayText(){return this.plugin.getTranslation().ribbonTooltip}async onOpen(){this.contentEl.empty(),this.contentEl.addClass("gyazo-view-container");let n=this.contentEl.createDiv({cls:"gyazo-react-container"});this.galleryRef.current=n,this.loading=!0,this.renderComponent(),await this.loadImages()}async onClose(){this.galleryRef.current&&N(null,this.galleryRef.current)}async refreshImages(){this.loading=!0,this.renderComponent(),await this.loadImages()}async loadImages(){try{this.images=await this.plugin.getGyazoImages(),this.loading=!1,this.error=null}catch(n){this.loading=!1,this.error=this.plugin.getTranslation().errorLoadingImages,console.error("Failed to load Gyazo images:",n)}this.renderComponent()}renderComponent(){this.reactComponent=u(ft,{images:this.images,loading:this.loading,error:this.error,translations:this.plugin.getTranslation(),onImageClick:this.handleImageClick.bind(this),onCopyButtonClick:this.onCopyButtonClick.bind(this),onContextMenu:this.handleContextMenu.bind(this),onRefresh:this.refreshImages.bind(this),plugin:this.plugin}),this.galleryRef.current&&N(this.reactComponent,this.galleryRef.current)}handleImageClick(n){this.openDetailView(n)}onCopyButtonClick(n){let o=U(n,this.plugin.settings);navigator.clipboard.writeText(o),this.showToast(this.plugin.getTranslation().imageCopiedToClipboard)}openDetailView(n){let o=this.app.workspace.getLeavesOfType(A).first();if(o?this.app.workspace.revealLeaf(o):(o=this.app.workspace.getLeaf("split","vertical"),o.setViewState({type:A,active:!0})),o.view instanceof x){let i=o.view;typeof i.setImage=="function"&&i.setImage(n)}}showToast(n){let o=createDiv({cls:"gyazo-toast",text:n});document.body.appendChild(o),window.setTimeout(()=>{o.classList.add("show")},10),window.setTimeout(()=>{o.classList.remove("show"),window.setTimeout(()=>{document.body.removeChild(o)},300)},2e3)}handleContextMenu(n,o){n.preventDefault();let i=new this.plugin.Menu,a=this.plugin.getTranslation();i.addItem(s=>{s.setTitle(a.copyUrl).setIcon("link").onClick(()=>{navigator.clipboard.writeText(o.permalink_url)})}),i.addItem(s=>{s.setTitle(a.openInBrowser).setIcon("external-link").onClick(()=>{window.open(o.permalink_url,"_blank")})}),i.showAtMouseEvent(n)}},ft=({images:t,loading:e,error:n,translations:o,onImageClick:i,onCopyButtonClick:a,onContextMenu:s,onRefresh:l,plugin:_})=>{let[c,p]=he(!1),[r,g]=he(null),d=h=>{if(!h.image_id||!h.permalink_url||!h.url){p(!0);return}g(h.image_id),window.setTimeout(()=>{g(null),i(h)},150)};if(e)return u("div",{className:"gyazo-loading",children:o.loadingImages});if(n)return u("div",{className:"gyazo-error",children:o.errorLoadingImages});if(!(_&&_.settings&&_.settings.accessToken))return u("div",{className:"gyazo-login-container",children:[u("h2",{children:o.noAccessToken}),u("div",{className:"gyazo-button-container",children:[u("p",{className:"gyazo-button-desc",children:o.openSettingsDesc}),u("button",{className:"gyazo-login-button",onClick:()=>{_&&_.openSettings()},children:o.openSettings}),u("p",{className:"gyazo-button-desc",children:o.openApiDashboardDesc}),u("button",{className:"gyazo-login-button",onClick:()=>{window.open("https://gyazo.com/oauth/applications","_blank")},children:o.openApiDashboard}),u("p",{className:"gyazo-button-desc",children:o.downloadGyazoDesc}),u("button",{className:"gyazo-login-button",onClick:()=>{window.open("https://gyazo.com/download","_blank")},children:o.downloadGyazo})]})]});if(!t.length)return u("div",{className:"gyazo-empty",children:o.noImages});let z=t;return u("div",{className:"gyazo-gallery",children:[u("div",{className:"gyazo-header",children:u("button",{className:"gyazo-refresh-button",onClick:l,title:o.refreshButton,children:[u("svg",{viewBox:"0 0 24 24",width:"14",height:"14",children:u("path",{fill:"currentColor",d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 9h7V2l-2.35 4.35z"})}),o.refreshButton]})}),u("div",{className:"gyazo-grid",children:z.map((h,y)=>{let m=!h.image_id||!h.permalink_url||!h.url,D=r===h.image_id;return u("div",{className:`gyazo-card ${m?"gyazo-locked":""} ${D?"clicked":""}`,onClick:()=>d(h),onContextMenu:b=>{m?p(!0):s(b,h)},children:[u("div",{className:"gyazo-thumbnail",style:{backgroundImage:`url(${h.thumb_url})`,backgroundSize:"cover"},role:"img",draggable:!0,onDragStart:b=>{!m&&b.dataTransfer?b.dataTransfer.setData("text/plain",U(h,_.settings)):p(!0)},children:h.type!=="png"&&u("div",{className:"gyazo-type-badge",children:h.type.toUpperCase()})}),u("div",{className:"gyazo-hover-overlay",children:u("div",{className:"gyazo-copy-button",onClick:b=>{b.stopPropagation(),m?p(!0):a(h)},children:u("svg",{viewBox:"0 0 24 24",width:"16",height:"16",children:u("path",{fill:"currentColor",d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})})})})]},h.image_id||`locked-${y}`)})}),c&&u("div",{className:"gyazo-pro-modal",children:u("div",{className:"gyazo-pro-modal-content",children:[u("h2",{children:o.upgradeToProTitle}),u("p",{children:o.upgradeToProDesc}),u("button",{className:"gyazo-pro-button",onClick:()=>window.open("https://gyazo.com/pro","_blank"),children:o.upgradeToProButton}),u("button",{className:"gyazo-close-button",onClick:()=>p(!1),children:"\u2715"})]})})]})};var oe=class extends T.Plugin{async onload(){await this.loadSettings(),this.api=new L(this.settings.accessToken),this.Menu=T.Menu,this.registerView(R,e=>new H(e,this)),this.registerView(A,e=>new x(e,this)),(0,T.addIcon)("gyazo",`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100" fill="none" data-__embeded-gyazo-content-j-s-teams="5.11.2" data-__gyazo-expander-enabled="true" data-__embeded-gyazo-content-j-s-dev="5.12.7500.23415">
<path fill-rule="evenodd" clip-rule="evenodd" d="M87.5000 42.8921H65.2313L82.0867 76.4725C82.0796 76.5017 82.0650 76.5309 82.0580 76.5667L82.0208 76.6625C82.0062 76.6975 81.9917 76.7325 81.9846 76.7608L81.9630 76.8258L81.9110 76.9433C81.9110 76.9433 81.8817 77.0192 81.8746 77.0400C81.8601 77.0750 81.8455 77.1083 81.8310 77.1442L81.7938 77.2329C81.7722 77.2883 81.7506 77.3383 81.7290 77.3937C81.7145 77.4229 81.6660 77.5225 81.6660 77.5225C81.6589 77.5442 81.6443 77.5658 81.6373 77.5808L81.5925 77.6575L81.5854 77.6650L81.5407 77.7525C81.5261 77.7800 81.5045 77.8150 81.4900 77.8433C81.4754 77.8650 81.4609 77.8942 81.4463 77.9208C81.4463 77.9208 81.4025 77.9942 81.3954 78.0108L81.3367 78.1037C81.2995 78.1625 81.2703 78.2150 81.2411 78.2592L81.1900 78.3383L81.1528 78.3883L81.0817 78.5067C81.0671 78.5350 81.0455 78.5642 81.0239 78.5875C81.0239 78.5875 80.9876 78.6392 80.9730 78.6608C80.9514 78.6900 80.9338 78.7192 80.9193 78.7475L80.8673 78.8250C80.2092 79.6900 79.4096 80.4433 78.4925 81.0437L67.7763 59.6967L23.2677 81.9275L23.2532 81.9204C23.2240 81.9133 23.1948 81.8996 23.1656 81.8850C23.1363 81.8704 23.1071 81.8633 23.0779 81.8487C23.0412 81.8342 23.0120 81.8196 22.9827 81.8050L22.9010 81.7667C22.8642 81.7521 22.8270 81.7375 22.7978 81.7229L22.7091 81.6863C22.6567 81.6654 22.6042 81.6354 22.5517 81.6146L22.4420 81.5629C22.4128 81.5483 22.3835 81.5412 22.3543 81.5267C22.3326 81.5196 22.2792 81.4883 22.2792 81.4883C22.2792 81.4883 22.2058 81.4521 22.1767 81.4375C22.1475 81.4230 22.1183 81.4084 22.0891 81.3938C22.0600 81.3792 22.0308 81.3646 22.0016 81.3429L21.9130 81.2883L21.8200 81.2275C21.7808 81.1992 21.7283 81.1700 21.6758 81.1417L21.5871 81.0900L21.5196 81.0458L21.4163 80.9800C21.3871 80.9583 21.3579 80.9437 21.3287 80.9192C21.3071 80.9046 21.2483 80.8613 21.2483 80.8613C21.2191 80.8396 21.1975 80.8250 21.1683 80.8092L21.0900 80.7521C20.2310 80.1213 19.4829 79.3483 18.8887 78.4321L40.2188 67.7775L17.9132 23.4400C18.5587 21.5825 19.8056 20.0000 21.4193 18.9200L32.0843 40.1130L87.3021 12.5000H26.5391C18.7861 12.5000 12.5000 18.7671 12.5000 26.4967V73.5033C12.5000 81.2329 18.7861 87.5000 26.5391 87.5000H73.4609C81.2139 87.5000 87.5000 81.2329 87.5000 73.5033V42.8921Z" fill="currentColor"/>
</svg>`),this.addRibbonIcon("gyazo",this.getTranslation().ribbonTooltip,async()=>{await this.activateView()}),this.addSettingTab(new q(this.app,this)),this.registerObsidianProtocolHandler("gyazo-oauth",async e=>{if(e.code)try{let n=await this.api.getAccessToken(e.code);this.settings.accessToken=n,this.api=new L(n),await this.saveSettings(),new T.Notice(this.getTranslation().loginButton+" "+this.getTranslation().save);let o=this.app.workspace.getLeavesOfType(R).first();o&&o.view instanceof H&&await o.view.refreshImages()}catch(n){console.error("Error getting access token:",n),new T.Notice("Failed to authenticate with Gyazo")}}),this.registerDomEvent(document,"dragover",e=>{e.preventDefault()}),this.registerDomEvent(document,"drop",async e=>{var i;e.preventDefault();let n=this.app.workspace.getActiveViewOfType(T.MarkdownView);if(!n)return;let o=n.editor;if((i=e.dataTransfer)!=null&&i.getData("gyazo/image")){let a=e.dataTransfer.getData("gyazo/image"),l=(await this.getGyazoImages()).find(_=>_.image_id===a);l&&o.replaceSelection(U(l,this.settings))}})}onunload(){}async loadSettings(){this.settings=Object.assign({},fe,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}getTranslation(){return ye[this.settings.language]}openSettings(){var n,o;let e=this.app;(n=e.setting)!=null&&n.open&&((o=e.setting)!=null&&o.openTabById)?(e.setting.open(),window.setTimeout(()=>{e.setting.openTabById("obsidian-gyazo-plugin")},100)):(console.error("Failed to open settings: 'setting' API is unavailable."),new T.Notice("Unable to open settings. Please check if the plugin is compatible with your Obsidian version."))}async getGyazoImages(){if(!this.settings.accessToken)return new T.Notice("Please set your Gyazo access token in the plugin settings"),[];try{return await this.api.getImages(100)}catch(e){return console.error("Error fetching Gyazo images:",e),new T.Notice("Failed to fetch Gyazo images. Check your access token and try again."),[]}}getActiveEditor(){let e=this.app.workspace.getActiveViewOfType(T.MarkdownView);return e?e.editor:null}async activateView(){let{workspace:e}=this.app,n=e.getLeavesOfType(R)[0];if(!n){let o=e.getRightLeaf(!1);o&&(n=o,await n.setViewState({type:R}))}n&&e.revealLeaf(n)}};

/* nosourcemap */